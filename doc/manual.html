<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
               "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
lang="en" xml:lang="en">
<head>
<title>Wat Language Manual</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<meta name="generator" content="Org-mode"/>
<meta name="generated" content="2012-08-28 01:27:42 CEST"/>
<meta name="author" content="Manuel Simoni"/>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  html { font-family: Times, serif; font-size: 12pt; }
  .title  { text-align: center; }
  .todo   { color: red; }
  .done   { color: green; }
  .tag    { background-color: #add8e6; font-weight:normal }
  .target { }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  p.verse { margin-left: 3% }
  pre {
	border: 1pt solid #AEBDCC;
	background-color: #F3F5F7;
	padding: 5pt;
	font-family: courier, monospace;
        font-size: 90%;
        overflow:auto;
  }
  table { border-collapse: collapse; }
  td, th { vertical-align: top; }
  dt { font-weight: bold; }
  div.figure { padding: 0.5em; }
  div.figure p { text-align: center; }
  .linenr { font-size:smaller }
  .code-highlighted {background-color:#ffff00;}
  .org-info-js_info-navigation { border-style:none; }
  #org-info-js_console-label { font-size:10px; font-weight:bold;
                               white-space:nowrap; }
  .org-info-js_search-highlight {background-color:#ffff00; color:#000000;
                                 font-weight:bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="stylesheet.css"/>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">

<h1 class="title">Wat Language Manual</h1>


<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Description </a></li>
<li><a href="#sec-2">Lexical Structure </a></li>
<li><a href="#sec-3">Built-in Types </a></li>
<li><a href="#sec-4">Pattern Matching </a></li>
<li><a href="#sec-5">Combiners </a></li>
<li><a href="#sec-6">Bindings and Environments </a>
<ul>
<li><a href="#sec-6.1"><code>def &lt;lhs&gt; &lt;rhs&gt; → rhs</code> [operative] </a></li>
<li><a href="#sec-6.2"><code>define &lt;lhs&gt; &lt;rhs&gt; → result</code> [operative] </a></li>
<li><a href="#sec-6.3"><code>define-syntax &lt;lhs&gt; &lt;rhs&gt; → result</code> [operative] </a></li>
<li><a href="#sec-6.4"><code>define-macro (&lt;name&gt; . &lt;ptree&gt;) . &lt;body&gt;</code> [operative] </a></li>
<li><a href="#sec-6.5"><code>set! &lt;env&gt; &lt;lhs&gt; &lt;rhs&gt; → rhs</code> [operative] </a></li>
<li><a href="#sec-6.6"><code>defined? &lt;sym&gt; &lt;env&gt; → boolean</code> [applicative] </a></li>
<li><a href="#sec-6.7"><code>provide &lt;names&gt; . &lt;exprs&gt; → result</code> [operative] </a></li>
<li><a href="#sec-6.8"><code>make-environment [&lt;parent&gt;] → environment</code> [applicative] </a></li>
<li><a href="#sec-6.9"><code>current-environment → environment</code> [applicative] </a></li>
</ul>
</li>
<li><a href="#sec-7">Combiners and Evaluation </a>
<ul>
<li><a href="#sec-7.1"><code>vau &lt;ptree&gt; &lt;envp&gt; . &lt;body&gt; → operative</code> [operative] </a></li>
<li><a href="#sec-7.2"><code>lambda &lt;ptree&gt; . &lt;exprs&gt; → applicative</code> [operative] </a></li>
<li><a href="#sec-7.3"><code>eval &lt;expr&gt; &lt;env&gt; → result</code> [applicative] </a></li>
<li><a href="#sec-7.4"><code>apply &lt;apv&gt; &lt;args&gt; → result</code> [applicative] </a></li>
<li><a href="#sec-7.5"><code>quote &lt;form&gt; → form</code> [operative] </a></li>
<li><a href="#sec-7.6"><code>wrap &lt;cmb&gt; → applicative</code> [applicative] </a></li>
<li><a href="#sec-7.7"><code>unwrap &lt;cmb&gt; → combiner</code> [applicative] </a></li>
</ul>
</li>
<li><a href="#sec-8">First-order Control </a>
<ul>
<li><a href="#sec-8.1"><code>begin . &lt;exprs&gt; → result</code> [operative] </a></li>
<li><a href="#sec-8.2"><code>if &lt;test&gt; &lt;then&gt; &lt;else&gt; → result</code> [operative] </a></li>
<li><a href="#sec-8.3"><code>when &lt;test&gt; . &lt;forms&gt; → result</code> [operative] </a></li>
<li><a href="#sec-8.4"><code>unless &lt;test&gt; . &lt;forms&gt; → result</code> [operative] </a></li>
<li><a href="#sec-8.5"><code>loop . &lt;forms&gt; → |</code> [operative] </a></li>
<li><a href="#sec-8.6"><code>while &lt;test&gt; . &lt;forms&gt; → |</code> [operative] </a></li>
<li><a href="#sec-8.7"><code>until &lt;test&gt; . &lt;forms&gt; → |</code> [operative] </a></li>
<li><a href="#sec-8.8"><code>block &lt;name&gt; . &lt;body&gt; → result</code> [operative] </a></li>
<li><a href="#sec-8.9"><code>return-from &lt;cont&gt; &lt;val&gt; → |</code> [operative] </a></li>
<li><a href="#sec-8.10"><code>unwind-protect &lt;protected&gt; . &lt;cleanup&gt; → result</code> [operative] </a></li>
</ul>
</li>
<li><a href="#sec-9">Dynamic Binding </a>
<ul>
<li><a href="#sec-9.1"><code>dnew &lt;val&gt; → dynamic</code> [applicative] </a></li>
<li><a href="#sec-9.2"><code>dlet &lt;dynamic&gt; &lt;value&gt; . &lt;exprs&gt; → result</code> [operative] </a></li>
<li><a href="#sec-9.3"><code>dref &lt;dynamic&gt; → value</code> [applicative] </a></li>
</ul>
</li>
<li><a href="#sec-10">Exceptions and Restarts </a>
<ul>
<li><a href="#sec-10.1"><code>handle &lt;body&gt; . &lt;handlers&gt; → result</code> [operative] <i>NIY</i> </a></li>
<li><a href="#sec-10.2"><code>catch &lt;body&gt; . &lt;handlers&gt; → result</code> [operative] <i>NIY</i> </a></li>
<li><a href="#sec-10.3"><code>default-handler &lt;exc&gt; → result</code> [generic]  <i>NIY</i> </a></li>
<li><a href="#sec-10.4"><code>throw &lt;exc&gt; . &lt;handlers&gt; → result</code> [operative] <i>NIY</i> </a></li>
<li><a href="#sec-10.5"><code>restart-bind &lt;body&gt; . &lt;handlers&gt; → result</code> [operative] <i>NIY</i> </a></li>
<li><a href="#sec-10.6"><code>invoke-restart &lt;restart&gt; → result</code> [applicative] <i>NIY</i> </a></li>
<li><a href="#sec-10.7"><code>compute-restarts &lt;exception&gt; → list</code> [applicative] <i>NIY</i> </a></li>
<li><a href="#sec-10.8"><code>associated-exception &lt;restart&gt; → exc</code> [generic] <i>NIY</i> </a></li>
</ul>
</li>
<li><a href="#sec-11">Higher-order Control </a>
<ul>
<li><a href="#sec-11.1"><code>make-prompt → prompt</code> [applicative] </a></li>
<li><a href="#sec-11.2"><code>push-prompt &lt;prompt&gt; . &lt;forms&gt; → result</code> [applicative] </a></li>
<li><a href="#sec-11.3"><code>take-subcont &lt;prompt&gt; &lt;cont&gt; . &lt;forms&gt; → result</code> [applicative] </a></li>
<li><a href="#sec-11.4"><code>push-subcont &lt;cont&gt; . &lt;forms&gt; → result</code> [applicative] </a></li>
</ul>
</li>
<li><a href="#sec-12">Types </a>
<ul>
<li><a href="#sec-12.1"><code>make-type → (type tagger untagger)</code> [applicative] </a></li>
<li><a href="#sec-12.2"><code>type-of &lt;val&gt; → type</code> [applicative] </a></li>
<li><a href="#sec-12.3"><code>Void</code>, <code>Ign</code>, <code>Boolean</code>, <code>Nil</code>, <code>Pair</code>, <code>Symbol</code>, <code>String</code>, <code>Number</code>, <code>Applicative</code>, <code>Operative</code>, <code>Environment</code>, <code>Vector</code>, <code>Type</code> [variables] </a></li>
<li><a href="#sec-12.4"><code>void?</code>, <code>ign?</code>, <code>boolean?</code>, <code>null?</code>, <code>pair?</code>, <code>symbol?</code>, <code>string?</code>, <code>number?</code>, <code>applicative?</code>, <code>operative?</code>, <code>environment?</code>, <code>vector?</code>, <code>type?</code> [applicatives] </a></li>
</ul>
</li>
<li><a href="#sec-13">Record Types </a>
<ul>
<li><a href="#sec-13.1"><code>define-record-type &lt;name&gt; &lt;ctor&gt; &lt;pred&gt; . &lt;fields&gt; → type</code> [operative] </a></li>
</ul>
</li>
<li><a href="#sec-14">Generic Functions and Methods </a>
<ul>
<li><a href="#sec-14.1"><code>define-generic (&lt;name&gt; . &lt;args&gt;) . [&lt;body&gt;] → generic</code> [operative] </a></li>
<li><a href="#sec-14.2"><code>define-method (&lt;name&gt; (&lt;self&gt; &lt;type&gt;) . &lt;args&gt;) . &lt;body&gt; → method</code> [operative] </a></li>
</ul>
</li>
<li><a href="#sec-15">Common Generic Functionality </a>
<ul>
<li><a href="#sec-15.1"><code>= &lt;a&gt; &lt;b&gt; → boolean</code> [generic] </a></li>
<li><a href="#sec-15.2"><code>/= &lt;a&gt; &lt;b&gt; → boolean</code> [applicative] </a></li>
<li><a href="#sec-15.3"><code>eq? &lt;a&gt; &lt;b&gt; → boolean</code> [applicative] </a></li>
<li><a href="#sec-15.4"><code>&lt; &lt;a&gt; &lt;b&gt; → boolean</code> [generic] </a></li>
<li><a href="#sec-15.5"><code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code> [applicatives] </a></li>
<li><a href="#sec-15.6"><code>hash-code &lt;obj&gt; → number</code> [generic] </a></li>
<li><a href="#sec-15.7"><code>identity-hash-code &lt;obj&gt; → number</code> [applicative] </a></li>
</ul>
</li>
<li><a href="#sec-16">Booleans </a>
<ul>
<li><a href="#sec-16.1"><code>and</code>, <code>or</code> [operatives] </a></li>
<li><a href="#sec-16.2"><code>not</code> [applicative] </a></li>
</ul>
</li>
<li><a href="#sec-17">Numbers </a>
<ul>
<li><a href="#sec-17.1"><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code> [applicatives] </a></li>
<li><a href="#sec-17.2"><code>-&gt;number &lt;obj&gt; → number</code> [generic] </a></li>
</ul>
</li>
<li><a href="#sec-18">Strings </a>
<ul>
<li><a href="#sec-18.1"><code>-&gt;string &lt;obj&gt; → string</code> [generic] </a></li>
</ul>
</li>
<li><a href="#sec-19">Pairs and Lists </a>
<ul>
<li><a href="#sec-19.1"><code>cons &lt;car&gt; &lt;cdr&gt; → cons</code> [applicative] </a></li>
<li><a href="#sec-19.2"><code>car &lt;pair&gt; → value</code> [applicative] </a></li>
<li><a href="#sec-19.3"><code>cdr &lt;pair&gt; → value</code> [applicative] </a></li>
<li><a href="#sec-19.4"><code>caar</code>, <code>cadr</code>, <code>cdar</code>, <code>cddr</code> [applicatives] </a></li>
<li><a href="#sec-19.5"><code>list . &lt;vals&gt; → list</code> [applicative] </a></li>
<li><a href="#sec-19.6"><code>list* . &lt;vals&gt; → list</code> [applicative] </a></li>
</ul>
</li>
<li><a href="#sec-20">Vectors </a>
<ul>
<li><a href="#sec-20.1"><code>vector . &lt;elements&gt; → vector</code> [applicative] </a></li>
<li><a href="#sec-20.2"><code>vector-ref &lt;vector&gt; &lt;index&gt; → element</code> [applicative] </a></li>
<li><a href="#sec-20.3"><code>vector-set! &lt;vector&gt; &lt;index&gt; &lt;element&gt; → element</code> [applicative] </a></li>
<li><a href="#sec-20.4"><code>vector-length &lt;vector&gt; → number</code> [applicative] </a></li>
</ul>
</li>
<li><a href="#sec-21">Hashtables </a>
<ul>
<li><a href="#sec-21.1"><code>Hashtable</code> [variable], <code>hashtable?</code> [applicative] <i>NIY</i> </a></li>
<li><a href="#sec-21.2"><code>make-hashtable &lt;hashfn&gt; &lt;eqfn&gt; → hashtable</code> [applicative] <i>NIY</i> </a></li>
<li><a href="#sec-21.3"><code>make-identity-hashtable → hashtable</code> [applicative] </a></li>
<li><a href="#sec-21.4"><code>make-generic-hashtable → hashtable</code> [applicative] <i>NIY</i> </a></li>
<li><a href="#sec-21.5"><code>hashtable-put! &lt;hashtable&gt; &lt;key&gt; &lt;val&gt; → val</code> [applicative] </a></li>
<li><a href="#sec-21.6"><code>hashtable-get &lt;hashtable&gt; &lt;key&gt; &lt;default&gt; → val</code> [applicative] </a></li>
</ul>
</li>
<li><a href="#sec-22">System </a>
<ul>
<li><a href="#sec-22.1"><code>read → form</code> [applicative] </a></li>
<li><a href="#sec-22.2"><code>display &lt;msg&gt; → msg</code> [applicative] </a></li>
<li><a href="#sec-22.3"><code>fail &lt;reason&gt; → |</code> [applicative] </a></li>
</ul>
</li>
<li><a href="#sec-23">JavaScript Bridge </a>
<ul>
<li><a href="#sec-23.1"><code>js-global &lt;string&gt; → result</code> [applicative] </a></li>
<li><a href="#sec-23.2"><code>js-set-global! &lt;string&gt; &lt;val&gt; → val</code> [applicative] </a></li>
<li><a href="#sec-23.3"><code>js-prop &lt;object&gt; &lt;string&gt; → result</code> [applicative] </a></li>
<li><a href="#sec-23.4"><code>js-set-prop! &lt;object&gt; &lt;string&gt; &lt;val&gt; → val</code> [applicative] </a></li>
<li><a href="#sec-23.5"><code>js-function &lt;jsfun&gt; → applicative</code> [applicative] </a></li>
<li><a href="#sec-23.6"><code>js-method &lt;string&gt; → cmb</code> [applicative] </a></li>
<li><a href="#sec-23.7"><code>to-js &lt;obj&gt; → jsobj</code> [applicative] </a></li>
<li><a href="#sec-23.8"><code>from-js &lt;js-obj&gt; → obj</code> [applicative] </a></li>
<li><a href="#sec-23.9"><code>js-callback &lt;cmb&gt; → jsfun</code> [applicative] </a></li>
<li><a href="#sec-23.10"><code>define-js-method &lt;name&gt;</code> [operative] </a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-1" class="outline-2">
<h2 id="sec-1">Description </h2>
<div class="outline-text-2" id="text-1">


<p>
<i>Wat</i> is an ultra-lightweight, advanced, and practical Lisp for
JavaScript, in which everything is first-class: syntax, control, and
data.  Syntax is based on lexically-scoped fexprs and first-class
environments, subsuming ordinary procedures and hygienic macros.
Control is based on delimited continuations, subsuming all
computational effects such as lightweight threads and monads.  Data
uses first-class types that allow generic programming over built-in as
well as user-defined types.  The language is rounded out with Common
Lisp features such as generic functions, restartable exceptions,
dynamically-bound variables, a numerical tower, preprocessing macros,
and common data structures such as hashtables.  The Wat runtime is
implemented in only 500 lines of JavaScript and evaluates the prelude
and a REPL written in Wat in under 50ms in common JavaScript
interpreters.
</p>
<p>
Wat is hosted at <a href="https://github.com/manuel/wat-js">https://github.com/manuel/wat-js</a>.
</p>
<p>
This manual assumes familiarity with Kernel, Scheme, and Common Lisp.
</p>
<p>
Sections marked with <i>NIY</i> are not implemented yet.
</p>
</div>

</div>

<div id="outline-container-2" class="outline-2">
<h2 id="sec-2">Lexical Structure </h2>
<div class="outline-text-2" id="text-2">


<p>
Wat has a mostly Scheme-like lexical structure, incompletely described
by the following table:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption></caption>
<colgroup><col align="left" /><col align="left" />
</colgroup>
<tbody>
<tr><td>; &hellip;</td><td><i>line comment</i></td></tr>
<tr><td>. + - [0-9]+</td><td><i>number</i></td></tr>
<tr><td>#t #f</td><td><i>logical constants</i></td></tr>
<tr><td>#void #ign</td><td><i>void and ignore constants</i></td></tr>
<tr><td>" &hellip; "</td><td><i>string</i></td></tr>
<tr><td>\\ \" \n \r \t</td><td><i>escape character in string</i></td></tr>
<tr><td>( &hellip; )</td><td><i>list</i></td></tr>
<tr><td>( a b . c )</td><td><i>dotted list</i></td></tr>
<tr><td>()</td><td><i>nil</i></td></tr>
<tr><td>a-z A-Z 0-9 - &amp; ! : = &gt; &lt; % + ? / * # $ _ ' .</td><td><i>symbol characters</i></td></tr>
<tr><td>'&lt;expr&gt;</td><td><i>short for</i> <code>(quote &lt;expr&gt;)</code></td></tr>
</tbody>
</table>


<p>
Wat identifiers are case-sensitive.
</p>
</div>

</div>

<div id="outline-container-3" class="outline-2">
<h2 id="sec-3">Built-in Types </h2>
<div class="outline-text-2" id="text-3">


<dl>
<dt>Void</dt><dd>
The constant <code>#void</code> is used when there is no interesting
value to return, or when a value is unspecified.

</dd>
<dt>Ignore</dt><dd>
The constant <code>#ign</code> is used in parameter lists to indicate
that an argument is ignored and should not be bound in the
combiner's environment.

</dd>
<dt>Boolean</dt><dd>
The <code>#t</code> constant represents logical truth and the <code>#f</code>
constant represents logical falsity.

</dd>
<dt>Nil and Pair</dt><dd>
Lists are built from immutable pairs and nil.
Notably, lists often contain not only symbols and literals (as is
usual in Lisp) but also first-class objects such as combiners.

</dd>
<dt>Symbol</dt><dd>
Symbols are used as identifiers for variable bindings.
It is not guaranteed that symbols with the same name are pointer
identical.

</dd>
<dt>String</dt><dd>
Wat currently only supports UTF-16 encoded Unicode
strings.

</dd>
<dt>Number</dt><dd>
Wat supports a full Scheme-style numeric tower with
arbitrary precision numbers.

</dd>
<dt>Vector</dt><dd>
An array of objects.

</dd>
<dt>Hashtable</dt><dd>
Wat currently only supports identity hashtables.

</dd>
<dt>Operative</dt><dd>
A combiner that operates directly on its operands.

</dd>
<dt>Applicative</dt><dd>
A combiner that evaluates its operands, yielding an
arguments list, which it passes to an underlying combiner.

</dd>
<dt>Macro</dt><dd>
Macros are used for optimization of syntactic abstraction.
When a macro appears as first element of a compound form, the
result of the macro will be evaluated instead of the original form.
The result of the macro is memoized in the syntax tree, so every
macro call is expanded only once, when it is first evaluated.

</dd>
<dt>Environment</dt><dd>
An environment maps symbols to values.  It may have
a parent environment in which symbols are looked up if they are not
found in this environment.

</dd>
<dt>Type</dt><dd>
A first-class type tag or just type is associated with
every object.

</dd>
<dt>Continuation</dt><dd>
Continuations are first-class objects, not wrapped
in an applicative.

</dd>
</dl>
</div>

</div>

<div id="outline-container-4" class="outline-2">
<h2 id="sec-4">Pattern Matching </h2>
<div class="outline-text-2" id="text-4">


<p>
As in Kernel, parameters and left-hand sides of definitions may not
only be symbols, but parameter trees: a parameter tree is either a
symbol, a cons, nil, or ignore.  A symbol binds the right hand to its
name, a cons recursively matches its car and cdr, nil matches only
nil, and ignore simply ignores the right-hand side.
</p>
<p>
Examples:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption></caption>
<colgroup><col align="left" /><col align="left" /><col align="left" />
</colgroup>
<thead>
<tr><th scope="col">Left-hand side</th><th scope="col">Right-hand side</th><th scope="col">Match results</th></tr>
</thead>
<tbody>
<tr><td>a</td><td>(1 (2) 3)</td><td>a → (1 (2) 3)</td></tr>
<tr><td>(a . b)</td><td>(1 (2) 3)</td><td>a → 1, b → ((2) 3)</td></tr>
<tr><td>(a b c)</td><td>(1 (2) 3)</td><td>a → 1, b → (2), c → 3</td></tr>
<tr><td>(a (b) . #ign)</td><td>(1 (2) 3)</td><td>a → 1, b → 2</td></tr>
</tbody>
</table>


</div>

</div>

<div id="outline-container-5" class="outline-2">
<h2 id="sec-5">Combiners </h2>
<div class="outline-text-2" id="text-5">


<p>
All computations in Wat are carried out by combiners, of which there
are two different kinds: operative and applicative (macros could also
be viewed as combiners, but are not discussed here).  An operative
combiner or just operative is a fexpr that receives the current
lexical environment and acts on its operand tree unevaluated.  An
applicative combiner or just applicative is a procedure that first
evaluates its operand tree and then passes the obtained arguments list
to an underlying combiner.  <code>vau</code> is the constructor of user-defined
operatives, called compound operatives.  <code>wrap</code> creates an applicative
around an underlying combiner.
</p>
<p>
Examples:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption></caption>
<colgroup><col align="left" /><col align="left" /><col align="left" />
</colgroup>
<thead>
<tr><th scope="col">Combiner</th><th scope="col">Operand Tree</th><th scope="col">Result</th></tr>
</thead>
<tbody>
<tr><td><code>(vau x #ign x)</code></td><td>(1 (+ 2 3) 4)</td><td>(1 (+ 2 3) 4)</td></tr>
<tr><td><code>(vau #ign e e)</code></td><td>(1 (+ 2 3) 4)</td><td><i>&lt;the current environment&gt;</i></td></tr>
<tr><td><code>(wrap (vau x #ign x))</code></td><td>(1 (+ 2 3) 4)</td><td>(1 5 4)</td></tr>
</tbody>
</table>


</div>

</div>

<div id="outline-container-6" class="outline-2">
<h2 id="sec-6">Bindings and Environments </h2>
<div class="outline-text-2" id="text-6">


</div>

<div id="outline-container-6.1" class="outline-3">
<h3 id="sec-6.1"><code>def &lt;lhs&gt; &lt;rhs&gt; → rhs</code> [operative] </h3>
<div class="outline-text-3" id="text-6.1">


<p>
Evaluates the right-hand side, matches the left-hand side against it
in the current environment, and returns it.
</p>
<p>
<code>def</code> is the fundamental binding operator, others such as <code>define</code> and
<code>define-syntax</code> are defined in terms of it.
</p>
<p>
<code>def</code> allows binding multiple values, as well as destructuring.
</p>

</div>

<div id="outline-container-6.1.1" class="outline-4">
<h4 id="sec-6.1.1">Examples </h4>
<div class="outline-text-4" id="text-6.1.1">





<pre class="example">(def x 1)
(assert (= x 1))

(def x 2)
(assert (= x 2))

(def (a b c) (list 1 (list 2) 3))
(assert (= a 1))
(assert (= b '(2)))
(assert (= c 3))

(def (a (b) c) (list 1 (list 2) 3))
(assert (= a 1))
(assert (= b 2))
(assert (= c 3))

(def (a . rest) (list 1 (list 2) 3))
(assert (= a 1))
(assert (= rest '((2) 3)))
</pre>




</div>
</div>

</div>

<div id="outline-container-6.2" class="outline-3">
<h3 id="sec-6.2"><code>define &lt;lhs&gt; &lt;rhs&gt; → result</code> [operative] </h3>
<div class="outline-text-3" id="text-6.2">


<p>
Scheme-like <code>define</code> with two cases:
</p>
<ul>
<li>
<code>(define &lt;name&gt; &lt;value&gt;)</code> simply binds name to value, returning value.

</li>
<li>
<code>(define (&lt;name&gt; . &lt;params&gt;) . &lt;body&gt;)</code> binds name to an
applicative with the given parameters and body expressions,
returning the applicative.

</li>
</ul>

</div>

<div id="outline-container-6.2.1" class="outline-4">
<h4 id="sec-6.2.1">Examples </h4>
<div class="outline-text-4" id="text-6.2.1">





<pre class="example">(define foo 1)
(assert (= foo 1))

(define foo 2)
(assert (= foo 2))

(define (bar) 12)
(assert (= (bar) 12))

(define (bar x y) (+ x y))
(assert (= (bar 1 2) 3))

(define (times number . rest)
  (map (lambda (x) (* number x)) rest))
(assert (= (times 3 1 2 3 4) '(3 6 9 12)))
</pre>




</div>
</div>

</div>

<div id="outline-container-6.3" class="outline-3">
<h3 id="sec-6.3"><code>define-syntax &lt;lhs&gt; &lt;rhs&gt; → result</code> [operative] </h3>
<div class="outline-text-3" id="text-6.3">


<p>
Scheme-like <code>define-syntax</code> with two cases:
</p>
<ul>
<li>
<code>(define-syntax &lt;name&gt; &lt;value&gt;)</code> simply binds name to value,
returning value.

</li>
<li>
<code>(define-syntax (&lt;name&gt; . &lt;params&gt;) &lt;envparam&gt; . &lt;body&gt;)</code> binds
name to an operative with the given parameters, environment
parameter, and body expressions, returning the operative.

</li>
</ul>

</div>

<div id="outline-container-6.3.1" class="outline-4">
<h4 id="sec-6.3.1">Examples </h4>
<div class="outline-text-4" id="text-6.3.1">





<pre class="example">(define-syntax my-quote (vau (x) #ign x))
(assert (= (my-quote foo) 'foo))

(define-syntax (my-when test . exprs) env
  (if (eval test env) (eval (list* begin exprs) env) #void))
(assert (= (my-when #t 1 2 3) 3))
(assert (= (my-when #f 1 2 3) #void))
</pre>




</div>
</div>

</div>

<div id="outline-container-6.4" class="outline-3">
<h3 id="sec-6.4"><code>define-macro (&lt;name&gt; . &lt;ptree&gt;) . &lt;body&gt;</code> [operative] </h3>
<div class="outline-text-3" id="text-6.4">


<p>
Defines a new macro with the given name, parameter tree, and body.
</p>

</div>

<div id="outline-container-6.4.1" class="outline-4">
<h4 id="sec-6.4.1">Examples </h4>
<div class="outline-text-4" id="text-6.4.1">





<pre class="example">(define-macro (my-let bindings . body)
  (cons (list* lambda (map car bindings) body)
        (map cadr bindings)))
(assert (= 3 (my-let ((x 1) (y 2))
               (+ x y))))

(define-macro (my-when test . exprs)
  (list if test (list* begin exprs) #void))
(assert (= (my-when #t 1 2 3) 3))
(assert (= (my-when #f 1 2 3) #void))
</pre>




</div>
</div>

</div>

<div id="outline-container-6.5" class="outline-3">
<h3 id="sec-6.5"><code>set! &lt;env&gt; &lt;lhs&gt; &lt;rhs&gt; → rhs</code> [operative] </h3>
<div class="outline-text-3" id="text-6.5">


<p>
Updates the left-hand side by matching it against the right-hand side
in the given environment.
</p>

</div>

<div id="outline-container-6.5.1" class="outline-4">
<h4 id="sec-6.5.1">Examples </h4>
<div class="outline-text-4" id="text-6.5.1">





<pre class="example">(define x 1)
(define x 2)

(set! (current-environment) x 3)
(set! (current-environment) y 4)
(assert (= x 3))
(assert (= y 4))

(set! (current-environment) (x y) (list y x))
(assert (= x 4))
(assert (= y 3))
</pre>




</div>
</div>

</div>

<div id="outline-container-6.6" class="outline-3">
<h3 id="sec-6.6"><code>defined? &lt;sym&gt; &lt;env&gt; → boolean</code> [applicative] </h3>
<div class="outline-text-3" id="text-6.6">


<p>
Returns true if a symbol is bound in the environment, false otherwise.
</p>

</div>

<div id="outline-container-6.6.1" class="outline-4">
<h4 id="sec-6.6.1">Examples </h4>
<div class="outline-text-4" id="text-6.6.1">





<pre class="example">(define x 1)
(assert (defined? 'x (current-environment)))
(assert (not (defined? 'y (current-environment))))
</pre>




</div>
</div>

</div>

<div id="outline-container-6.7" class="outline-3">
<h3 id="sec-6.7"><code>provide &lt;names&gt; . &lt;exprs&gt; → result</code> [operative] </h3>
<div class="outline-text-3" id="text-6.7">


<p>
Performs expressions in a new environment and exports only listed
names to the outer environment.
</p>

</div>

<div id="outline-container-6.7.1" class="outline-4">
<h4 id="sec-6.7.1">Examples </h4>
<div class="outline-text-4" id="text-6.7.1">





<pre class="example">(provide (foo bar)
  (define foo 1)
  (define bar 2)
  (define quux 3)
)
(assert (= 1 foo))
(assert (= 2 bar))
(assert (not (defined? 'quux (current-environment))))
</pre>




</div>
</div>

</div>

<div id="outline-container-6.8" class="outline-3">
<h3 id="sec-6.8"><code>make-environment [&lt;parent&gt;] → environment</code> [applicative] </h3>
<div class="outline-text-3" id="text-6.8">


<p>
Creates a new empty environment with the given optional parent.
</p>

</div>

<div id="outline-container-6.8.1" class="outline-4">
<h4 id="sec-6.8.1">Examples </h4>
<div class="outline-text-4" id="text-6.8.1">





<pre class="example">(define e (make-environment))
(eval (list define 'x 1) e)
(assert (= 1 (eval 'x e)))

(define f (make-environment e))
(assert (= 1 (eval 'x f)))

(eval (list define 'x 2) f)
(assert (= 1 (eval 'x e)))
(assert (= 2 (eval 'x f)))
</pre>




</div>
</div>

</div>

<div id="outline-container-6.9" class="outline-3">
<h3 id="sec-6.9"><code>current-environment → environment</code> [applicative] </h3>
<div class="outline-text-3" id="text-6.9">


<p>
Returns the current environment.
</p>

</div>

<div id="outline-container-6.9.1" class="outline-4">
<h4 id="sec-6.9.1">Examples </h4>
<div class="outline-text-4" id="text-6.9.1">





<pre class="example">(define x 1)
(assert (=  1 (eval 'x (current-environment))))

(define (foo)
  (let ((y 2))
    (current-environment)))
(assert (= 2 (eval 'y (foo))))
</pre>




</div>
</div>
</div>

</div>

<div id="outline-container-7" class="outline-2">
<h2 id="sec-7">Combiners and Evaluation </h2>
<div class="outline-text-2" id="text-7">


</div>

<div id="outline-container-7.1" class="outline-3">
<h3 id="sec-7.1"><code>vau &lt;ptree&gt; &lt;envp&gt; . &lt;body&gt; → operative</code> [operative] </h3>
<div class="outline-text-3" id="text-7.1">


<p>
Constructs a new compound operative that closes over the current
environment with the given parameter tree, environment parameter, and
body expression.
</p>

</div>

<div id="outline-container-7.1.1" class="outline-4">
<h4 id="sec-7.1.1">Examples </h4>
<div class="outline-text-4" id="text-7.1.1">





<pre class="example">(define foo (vau (x) #ign x))
(assert (= '(+ 1 2) (foo (+ 1 2))))

(define bar (vau (x) env (eval x env)))
(assert (= 3 (bar (+ 1 2))))
</pre>




</div>
</div>

</div>

<div id="outline-container-7.2" class="outline-3">
<h3 id="sec-7.2"><code>lambda &lt;ptree&gt; . &lt;exprs&gt; → applicative</code> [operative] </h3>
<div class="outline-text-3" id="text-7.2">


<p>
Creates an applicative combiner, as in Scheme.
</p>

</div>

<div id="outline-container-7.2.1" class="outline-4">
<h4 id="sec-7.2.1">Examples </h4>
<div class="outline-text-4" id="text-7.2.1">





<pre class="example">(define foo (lambda (x) (+ x 1)))
(assert (= 2 (foo 1)))

(define quux (lambda args args))
(assert (= '(1 2) (quux 1 (+ 1 1))))
</pre>




</div>
</div>

</div>

<div id="outline-container-7.3" class="outline-3">
<h3 id="sec-7.3"><code>eval &lt;expr&gt; &lt;env&gt; → result</code> [applicative] </h3>
<div class="outline-text-3" id="text-7.3">


<p>
Evaluates the expression in the given environment.
</p>

</div>

<div id="outline-container-7.3.1" class="outline-4">
<h4 id="sec-7.3.1">Examples </h4>
<div class="outline-text-4" id="text-7.3.1">





<pre class="example">(assert (= 4 (eval (list + 2 2) (current-environment))))
</pre>




</div>
</div>

</div>

<div id="outline-container-7.4" class="outline-3">
<h3 id="sec-7.4"><code>apply &lt;apv&gt; &lt;args&gt; → result</code> [applicative] </h3>
<div class="outline-text-3" id="text-7.4">


<p>
Applies an applicative to an arguments list.
</p>

</div>

<div id="outline-container-7.4.1" class="outline-4">
<h4 id="sec-7.4.1">Examples </h4>
<div class="outline-text-4" id="text-7.4.1">





<pre class="example">(assert (= 4 (apply + (list 2 2))))
</pre>




</div>
</div>

</div>

<div id="outline-container-7.5" class="outline-3">
<h3 id="sec-7.5"><code>quote &lt;form&gt; → form</code> [operative] </h3>
<div class="outline-text-3" id="text-7.5">


<p>
Returns form unevaluated.
</p>

</div>

<div id="outline-container-7.5.1" class="outline-4">
<h4 id="sec-7.5.1">Examples </h4>
<div class="outline-text-4" id="text-7.5.1">





<pre class="example">(assert (= '+ (car (quote (+ 2 2)))))
</pre>




</div>
</div>

</div>

<div id="outline-container-7.6" class="outline-3">
<h3 id="sec-7.6"><code>wrap &lt;cmb&gt; → applicative</code> [applicative] </h3>
<div class="outline-text-3" id="text-7.6">


<p>
Returns an applicative around an underlying combiner.
</p>

</div>

<div id="outline-container-7.6.1" class="outline-4">
<h4 id="sec-7.6.1">Examples </h4>
<div class="outline-text-4" id="text-7.6.1">





<pre class="example">(define id (vau (x) #ign x))
(assert (= '(+ 1 2) (id (+ 1 2))))
(assert (= 3 ((wrap id) (+ 1 2))))
</pre>




</div>
</div>

</div>

<div id="outline-container-7.7" class="outline-3">
<h3 id="sec-7.7"><code>unwrap &lt;cmb&gt; → combiner</code> [applicative] </h3>
<div class="outline-text-3" id="text-7.7">


<p>
Returns the underlying combiner of an applicative.
</p>

</div>

<div id="outline-container-7.7.1" class="outline-4">
<h4 id="sec-7.7.1">Examples </h4>
<div class="outline-text-4" id="text-7.7.1">





<pre class="example">(define foo (lambda (a b) (+ a b)))
(assert (= 7 ((unwrap foo) 3 4)))
</pre>




</div>
</div>
</div>

</div>

<div id="outline-container-8" class="outline-2">
<h2 id="sec-8">First-order Control </h2>
<div class="outline-text-2" id="text-8">


</div>

<div id="outline-container-8.1" class="outline-3">
<h3 id="sec-8.1"><code>begin . &lt;exprs&gt; → result</code> [operative] </h3>
<div class="outline-text-3" id="text-8.1">


<p>
Evaluates expressions from left to right, returning the value of the
last.  As a special case, <code>(begin)</code> returns void.
</p>

</div>

<div id="outline-container-8.1.1" class="outline-4">
<h4 id="sec-8.1.1">Examples </h4>
<div class="outline-text-4" id="text-8.1.1">





<pre class="example">(assert (= #void (begin)))
(assert (= 1 (begin 1)))
(assert (= 2 (begin 1 2)))
(assert (= 3 (begin 1 2 3)))
</pre>




</div>
</div>

</div>

<div id="outline-container-8.2" class="outline-3">
<h3 id="sec-8.2"><code>if &lt;test&gt; &lt;then&gt; &lt;else&gt; → result</code> [operative] </h3>
<div class="outline-text-3" id="text-8.2">


<p>
Evaluates the test, and if it is false evaluates the else branch,
otherwise evaluates the then branch.
</p>

</div>

<div id="outline-container-8.2.1" class="outline-4">
<h4 id="sec-8.2.1">Examples </h4>
<div class="outline-text-4" id="text-8.2.1">





<pre class="example">(assert (= 1 (if #t 1 2)))
(assert (= 2 (if #f 1 2)))
(assert (= 1 (if 'foo 1 2)))
</pre>




</div>
</div>

</div>

<div id="outline-container-8.3" class="outline-3">
<h3 id="sec-8.3"><code>when &lt;test&gt; . &lt;forms&gt; → result</code> [operative] </h3>
<div class="outline-text-3" id="text-8.3">


<p>
Evaluates forms if test is true, returns void otherwise.
</p>

</div>

<div id="outline-container-8.3.1" class="outline-4">
<h4 id="sec-8.3.1">Examples </h4>
<div class="outline-text-4" id="text-8.3.1">





<pre class="example">(assert (= 2 (when #t 1 2)))
(assert (= #void (when #f 1 2)))
(assert (= 2 (when 'foo 1 2)))
</pre>




</div>
</div>

</div>

<div id="outline-container-8.4" class="outline-3">
<h3 id="sec-8.4"><code>unless &lt;test&gt; . &lt;forms&gt; → result</code> [operative] </h3>
<div class="outline-text-3" id="text-8.4">


<p>
Evaluates forms if test is false, returns void otherwise.
</p>

</div>

<div id="outline-container-8.4.1" class="outline-4">
<h4 id="sec-8.4.1">Examples </h4>
<div class="outline-text-4" id="text-8.4.1">





<pre class="example">(assert (= #void (unless #t 1 2)))
(assert (= 2 (unless #f 1 2)))
(assert (= #void (unless 'foo 1 2)))
</pre>




</div>
</div>

</div>

<div id="outline-container-8.5" class="outline-3">
<h3 id="sec-8.5"><code>loop . &lt;forms&gt; → |</code> [operative] </h3>
<div class="outline-text-3" id="text-8.5">


<p>
Infinite loop.
</p>

</div>

<div id="outline-container-8.5.1" class="outline-4">
<h4 id="sec-8.5.1">Examples </h4>
<div class="outline-text-4" id="text-8.5.1">





<pre class="example">(assert
  (= 11
     (block exit 
       (define x 0)
       (loop
         (set! (current-environment) x (+ x 1))
         (when (&gt; x 10)
           (return-from exit x))))))
</pre>




</div>
</div>

</div>

<div id="outline-container-8.6" class="outline-3">
<h3 id="sec-8.6"><code>while &lt;test&gt; . &lt;forms&gt; → |</code> [operative] </h3>
<div class="outline-text-3" id="text-8.6">


<p>
Performs forms while test is true.
</p>

</div>

<div id="outline-container-8.6.1" class="outline-4">
<h4 id="sec-8.6.1">Examples </h4>
<div class="outline-text-4" id="text-8.6.1">





<pre class="example">(define x 0)
(while (&lt;= x 10)
  (set! (current-environment) x (+ x 1)))
(assert (= x 11))
</pre>




</div>
</div>

</div>

<div id="outline-container-8.7" class="outline-3">
<h3 id="sec-8.7"><code>until &lt;test&gt; . &lt;forms&gt; → |</code> [operative] </h3>
<div class="outline-text-3" id="text-8.7">


<p>
Performs forms until test is true.
</p>

</div>

<div id="outline-container-8.7.1" class="outline-4">
<h4 id="sec-8.7.1">Examples </h4>
<div class="outline-text-4" id="text-8.7.1">





<pre class="example">(define x 0)
(until (&gt; x 10)
  (set! (current-environment) x (+ x 1)))
(assert (= x 11))
</pre>




</div>
</div>

</div>

<div id="outline-container-8.8" class="outline-3">
<h3 id="sec-8.8"><code>block &lt;name&gt; . &lt;body&gt; → result</code> [operative] </h3>
<div class="outline-text-3" id="text-8.8">


<p>
Performs body forms with name bound to a one-shot escape continuation
that can be invoked with <code>return-from</code>.
</p>

</div>

<div id="outline-container-8.8.1" class="outline-4">
<h4 id="sec-8.8.1">Examples </h4>
<div class="outline-text-4" id="text-8.8.1">





<pre class="example">(assert (= #void (block foo)))
(assert (= 1 (block foo 1)))
(assert (= 2 (block foo 1 2)))
(assert (= 3 (block foo 1 (return-from foo 3) 2)))

(assert (= 3 (block ret
               (for-each (lambda (x) (when (= 1 (/ x 3)) (return-from ret x)))
                         '(1 2 3 4 5)))))
</pre>




</div>
</div>

</div>

<div id="outline-container-8.9" class="outline-3">
<h3 id="sec-8.9"><code>return-from &lt;cont&gt; &lt;val&gt; → |</code> [operative] </h3>
<div class="outline-text-3" id="text-8.9">


<p>
Invokes a one-shot escape continuation bound by <code>block</code>, passing it
the given value.
</p>
<p>
An error is signalled if the continuation's extent has ended.
</p>
</div>

</div>

<div id="outline-container-8.10" class="outline-3">
<h3 id="sec-8.10"><code>unwind-protect &lt;protected&gt; . &lt;cleanup&gt; → result</code> [operative] </h3>
<div class="outline-text-3" id="text-8.10">


<p>
Executes and returns the value of the protected form.  When control
exits the protected form, either normally by a return, or abnormally
through an escape continuation, the cleanup forms are executed.  The
cleanup forms are not executed when the protected form is aborted by
higher-order control.
</p>

</div>

<div id="outline-container-8.10.1" class="outline-4">
<h4 id="sec-8.10.1">Examples </h4>
<div class="outline-text-4" id="text-8.10.1">





<pre class="example">(assert (= 1 (unwind-protect 1)))
(assert (= 1 (unwind-protect 1 2)))
(assert (= 1 (unwind-protect 1 2 3)))

(define env (current-environment))

(define x #f)
(assert (= 1 (unwind-protect 1 (set! env x #t))))
(assert (= #t x))
</pre>




</div>
</div>
</div>

</div>

<div id="outline-container-9" class="outline-2">
<h2 id="sec-9">Dynamic Binding </h2>
<div class="outline-text-2" id="text-9">



</div>

<div id="outline-container-9.1" class="outline-3">
<h3 id="sec-9.1"><code>dnew &lt;val&gt; → dynamic</code> [applicative] </h3>
<div class="outline-text-3" id="text-9.1">


<p>
Creates a new dynamically-bound variable with the given global value,
which will be used when there is no dynamic binding.
</p>
</div>

</div>

<div id="outline-container-9.2" class="outline-3">
<h3 id="sec-9.2"><code>dlet &lt;dynamic&gt; &lt;value&gt; . &lt;exprs&gt; → result</code> [operative] </h3>
<div class="outline-text-3" id="text-9.2">


<p>
Performs expressions with the dynamic variable bound to the value.
</p>
</div>

</div>

<div id="outline-container-9.3" class="outline-3">
<h3 id="sec-9.3"><code>dref &lt;dynamic&gt; → value</code> [applicative] </h3>
<div class="outline-text-3" id="text-9.3">


<p>
Retrieves the value of a dynamic variable.
</p>
</div>
</div>

</div>

<div id="outline-container-10" class="outline-2">
<h2 id="sec-10">Exceptions and Restarts </h2>
<div class="outline-text-2" id="text-10">


<p>
Wat's exception handling is based on the condition system of Common
Lisp.  Foremost is the ability to continue at the point of an
exception by invoking a restart handler.
</p>

</div>

<div id="outline-container-10.1" class="outline-3">
<h3 id="sec-10.1"><code>handle &lt;body&gt; . &lt;handlers&gt; → result</code> [operative] <i>NIY</i> </h3>
<div class="outline-text-3" id="text-10.1">


<p>
<code>handle</code> establishes exception handlers for the duration of the
evaluation of the body form.  When one of the handlers matches a
thrown exception, it will be called on the stack - i.e. the stack is
not unwound.
</p>
<p>
Each handler is of the form <code>(&lt;type&gt; (&lt;var&gt;) . &lt;handler-body&gt;)</code>.
Handlers are matched against a thrown exception from left to right.
If a thrown exception is of the given type, then the <code>&lt;handler-body&gt;</code>
expressions will be executed with the variable <code>&lt;var&gt;</code> bound to the
exception.
</p>
<p>
A handler may handle the exception by performing a nonlocal transfer
of control explicitly with <code>return-from</code>, or implicitly with
e.g. <code>invoke-restart</code>.  If the handler normally returns, the search
for a handler continues up the stack to the next outer <code>handle</code> or
<code>catch</code>.  If one of the handlers of a <code>handle</code> form matches an
exception, no other handler of that form will be tried if it returns
normally.  If no handler is found, the <code>default-handler</code> generic
function is called on the exception.
</p>
<p>
While a handler body is executed, the current handlers are those that
were established at the time <code>handle</code> was called.  This is analogous
to Common Lisp's <a href="http://www.nhplace.com/kent/Papers/Condition-Handling-2001.html">condition firewall</a>.
</p></div>

</div>

<div id="outline-container-10.2" class="outline-3">
<h3 id="sec-10.2"><code>catch &lt;body&gt; . &lt;handlers&gt; → result</code> [operative] <i>NIY</i> </h3>
<div class="outline-text-3" id="text-10.2">


<p>
Like <code>handle</code>, but unwinds the stack before executing handler, and
simply returns the result of evaluating the handler body.  The handler
may rethrow the exception.
</p>
</div>

</div>

<div id="outline-container-10.3" class="outline-3">
<h3 id="sec-10.3"><code>default-handler &lt;exc&gt; → result</code> [generic]  <i>NIY</i> </h3>
<div class="outline-text-3" id="text-10.3">


<p>
Called on an exception when no handler is found, or when all found
handlers returned normally.
</p>
</div>

</div>

<div id="outline-container-10.4" class="outline-3">
<h3 id="sec-10.4"><code>throw &lt;exc&gt; . &lt;handlers&gt; → result</code> [operative] <i>NIY</i> </h3>
<div class="outline-text-3" id="text-10.4">


<p>
Throws an exception and optionally binds restart handlers that an
exception handler may use to continue computation.  Restart handlers
are installed as if by <code>catch</code>, i.e. when a restart is invoked, the
stack is unwound and the result of the restart handler is returned.
<code>throw</code> only returns normally if one of its restart handlers is
invoked, otherwise it always enters the debugger or crashes the
program.  The restart handlers are associated with the thrown
exception, and only match invoked restarts whose
<code>associated-exception</code> is the thrown exception.
</p>
</div>

</div>

<div id="outline-container-10.5" class="outline-3">
<h3 id="sec-10.5"><code>restart-bind &lt;body&gt; . &lt;handlers&gt; → result</code> [operative] <i>NIY</i> </h3>
<div class="outline-text-3" id="text-10.5">


<p>
Executes a body form with restart handlers in effect.  Restart
handlers are installed as if by <code>catch</code>, i.e. when a restart is
invoked, the stack is unwound and the result of the restart handler is
returned.  If any condition happens during evaluation of the body, the
restart handlers will be effective as per <code>compute-restarts</code>.  This is
unlike the restart handlers bound by a <code>throw</code>, which are associated
with the thrown exception.  Restart handlers bound by <code>restart-bind</code>
are not associated with any exception.
</p>
</div>

</div>

<div id="outline-container-10.6" class="outline-3">
<h3 id="sec-10.6"><code>invoke-restart &lt;restart&gt; → result</code> [applicative] <i>NIY</i> </h3>
<div class="outline-text-3" id="text-10.6">


<p>
Searches the stack for a restart handler established by a <code>throw</code> or
<code>restart-bind</code> that matches the restart, unwinds, and evaluates the
handler body.  If no restart handler is found, an exception is thrown.
</p>
</div>

</div>

<div id="outline-container-10.7" class="outline-3">
<h3 id="sec-10.7"><code>compute-restarts &lt;exception&gt; → list</code> [applicative] <i>NIY</i> </h3>
<div class="outline-text-3" id="text-10.7">


<p>
Returns a list of restart handlers that are effective for the given
exception.  Restart handlers bound by <code>restart-bind</code> are effective for
any exception, whereas restart handlers bound by <code>throw</code> are only
effective for the thrown exception.
</p>
</div>

</div>

<div id="outline-container-10.8" class="outline-3">
<h3 id="sec-10.8"><code>associated-exception &lt;restart&gt; → exc</code> [generic] <i>NIY</i> </h3>
<div class="outline-text-3" id="text-10.8">


<p>
A restart intended for a restart handler established by <code>throw</code> must
have the thrown exception as associated exception.  Its type should
implement a method for this generic function that returns the
restart's associated exception.
</p>

</div>

<div id="outline-container-10.8.1" class="outline-4">
<h4 id="sec-10.8.1">Examples </h4>
<div class="outline-text-4" id="text-10.8.1">





<pre class="example">;; (define-record-type Div-by-Zero-Exception
;;   (make-div-by-zero-exception)
;;   #ign)

;; (define-record-type Use-Value-Restart
;;   (make-use-value-restart value associated-exception)
;;   #ign
;;   (value value)
;;   (associated-exception associated-exception))

;; (define (my-compute number divisor)
;;   (let ((div (if (= 0 divisor)
;;                  (throw (make-div-by-zero-exception)
;;                    (Use-Value-Restart (r) (value r)))
;;                  divisor)))
;;     (/ number div)))

;; (assert 
;;   (= (handle (my-compute 12 0)
;;        (Div-by-Zero-Exception (dbz) (invoke-restart (make-use-value-restart 3 dbz))))
;;      4))
</pre>




</div>
</div>
</div>

</div>

<div id="outline-container-11" class="outline-2">
<h2 id="sec-11">Higher-order Control </h2>
<div class="outline-text-2" id="text-11">


<p>
These are the control operators from Dybvig, Jones, and Sabry's
<a href="http://www.cs.indiana.edu/~dyb/pubs/monadicDC.pdf"><i>A Monadic Framework for Delimited Continuations</i></a> that are able to express all
other delimited control operators.
</p>

</div>

<div id="outline-container-11.1" class="outline-3">
<h3 id="sec-11.1"><code>make-prompt → prompt</code> [applicative] </h3>
<div class="outline-text-3" id="text-11.1">


<p>
Creates a fresh prompt.
</p>
</div>

</div>

<div id="outline-container-11.2" class="outline-3">
<h3 id="sec-11.2"><code>push-prompt &lt;prompt&gt; . &lt;forms&gt; → result</code> [applicative] </h3>
<div class="outline-text-3" id="text-11.2">


<p>
Pushes the continuation-delimiting prompt and executes forms in the
new continuation.
</p>
</div>

</div>

<div id="outline-container-11.3" class="outline-3">
<h3 id="sec-11.3"><code>take-subcont &lt;prompt&gt; &lt;cont&gt; . &lt;forms&gt; → result</code> [applicative] </h3>
<div class="outline-text-3" id="text-11.3">


<p>
Aborts up to and including the prompt, and performs the forms with
<code>&lt;cont&gt;</code> bound to the delimited continuation from the call to
<code>take-subcont</code> up to but not including the prompt.
</p>
</div>

</div>

<div id="outline-container-11.4" class="outline-3">
<h3 id="sec-11.4"><code>push-subcont &lt;cont&gt; . &lt;forms&gt; → result</code> [applicative] </h3>
<div class="outline-text-3" id="text-11.4">


<p>
Prepends the delimited continuation to the current continuation, and
performs forms in the new continuation.
</p>

</div>

<div id="outline-container-11.4.1" class="outline-4">
<h4 id="sec-11.4.1">Examples </h4>
<div class="outline-text-4" id="text-11.4.1">





<pre class="example">(assert
  (= (let ((p (make-prompt)))
       (+ 2 (push-prompt p
              (if (take-subcont p k
                    (+ (push-subcont k #f)
                       (push-subcont k #t)))
                  3
                  4))))
     9))
</pre>




</div>
</div>
</div>

</div>

<div id="outline-container-12" class="outline-2">
<h2 id="sec-12">Types </h2>
<div class="outline-text-2" id="text-12">


</div>

<div id="outline-container-12.1" class="outline-3">
<h3 id="sec-12.1"><code>make-type → (type tagger untagger)</code> [applicative] </h3>
<div class="outline-text-3" id="text-12.1">


<p>
Returns a list containing:
</p>
<ul>
<li>
a fresh first-class type;

</li>
<li>
an applicative, the tagger, that takes a value and tags it with the
type;

</li>
<li>
an applicative, the untagger, that takes a tagged object created by
the tagger and returns its value.

</li>
</ul>

<p>The untagger only untags objects created by the tagger.
</p>
</div>

</div>

<div id="outline-container-12.2" class="outline-3">
<h3 id="sec-12.2"><code>type-of &lt;val&gt; → type</code> [applicative] </h3>
<div class="outline-text-3" id="text-12.2">


<p>
Returns an object's type.  Every object has a type, whether built-in
objects or tagged objects.
</p>
</div>

</div>

<div id="outline-container-12.3" class="outline-3">
<h3 id="sec-12.3"><code>Void</code>, <code>Ign</code>, <code>Boolean</code>, <code>Nil</code>, <code>Pair</code>, <code>Symbol</code>, <code>String</code>, <code>Number</code>, <code>Applicative</code>, <code>Operative</code>, <code>Environment</code>, <code>Vector</code>, <code>Type</code> [variables] </h3>
<div class="outline-text-3" id="text-12.3">


<p>
Type constants for built-in types.
</p>
</div>

</div>

<div id="outline-container-12.4" class="outline-3">
<h3 id="sec-12.4"><code>void?</code>, <code>ign?</code>, <code>boolean?</code>, <code>null?</code>, <code>pair?</code>, <code>symbol?</code>, <code>string?</code>, <code>number?</code>, <code>applicative?</code>, <code>operative?</code>, <code>environment?</code>, <code>vector?</code>, <code>type?</code> [applicatives] </h3>
<div class="outline-text-3" id="text-12.4">


<p>
Type predicates for built-in types.
</p>
</div>
</div>

</div>

<div id="outline-container-13" class="outline-2">
<h2 id="sec-13">Record Types </h2>
<div class="outline-text-2" id="text-13">


</div>

<div id="outline-container-13.1" class="outline-3">
<h3 id="sec-13.1"><code>define-record-type &lt;name&gt; &lt;ctor&gt; &lt;pred&gt; . &lt;fields&gt; → type</code> [operative] </h3>
<div class="outline-text-3" id="text-13.1">


<p>
Defines a new record type with the given name.
</p>
<p>
<code>ctor</code> is of the form <code>(ctor-name . ctor-args)</code>.  <code>ctor-name</code> is bound
to a function that takes <code>ctor-args</code>, which must be record field
names, as arguments, and creates a new instance of the record type
with the given fields initialized to the arguments.
</p>
<p>
<code>pred</code> is bound to a function of one argument that returns true iff an
object is an instance of the record type.
</p>
<p>
Each element of <code>fields</code> is of the form:
</p>
<ul>
<li>
<code>(name accessor-name)</code>, or

</li>
<li>
<code>(name accessor-name modifier-name)</code>.

</li>
</ul>

</div>

<div id="outline-container-13.1.1" class="outline-4">
<h4 id="sec-13.1.1">Examples </h4>
<div class="outline-text-4" id="text-13.1.1">





<pre class="example">(define-record-type Person
  (make-person name email)
  person?
  (name get-name set-name!)
  (email get-email set-email!))
</pre>




</div>
</div>
</div>

</div>

<div id="outline-container-14" class="outline-2">
<h2 id="sec-14">Generic Functions and Methods </h2>
<div class="outline-text-2" id="text-14">


</div>

<div id="outline-container-14.1" class="outline-3">
<h3 id="sec-14.1"><code>define-generic (&lt;name&gt; . &lt;args&gt;) . [&lt;body&gt;] → generic</code> [operative] </h3>
<div class="outline-text-3" id="text-14.1">


<p>
Defines a new generic function.  If the optional body expressions are
supplied, a default method is installed that will be used when no
type-specific method is found.
</p>
</div>

</div>

<div id="outline-container-14.2" class="outline-3">
<h3 id="sec-14.2"><code>define-method (&lt;name&gt; (&lt;self&gt; &lt;type&gt;) . &lt;args&gt;) . &lt;body&gt; → method</code> [operative] </h3>
<div class="outline-text-3" id="text-14.2">


<p>
Adds a method to a generic function.
</p>

</div>

<div id="outline-container-14.2.1" class="outline-4">
<h4 id="sec-14.2.1">Examples </h4>
<div class="outline-text-4" id="text-14.2.1">





<pre class="example">(define-generic (-&gt;number obj))
(define-method (-&gt;number (self Number))
  self)
(define-method (-&gt;number (self String))
  (string-&gt;number self))
(define-method (-&gt;number (self Symbol))
  (string-&gt;number (symbol-&gt;string self)))
</pre>




</div>
</div>
</div>

</div>

<div id="outline-container-15" class="outline-2">
<h2 id="sec-15">Common Generic Functionality </h2>
<div class="outline-text-2" id="text-15">


</div>

<div id="outline-container-15.1" class="outline-3">
<h3 id="sec-15.1"><code>= &lt;a&gt; &lt;b&gt; → boolean</code> [generic] </h3>
<div class="outline-text-3" id="text-15.1">


<p>
Generic equality predicate.  Different types may attach different
methods to this generic function.  If no method is defined for a type,
falls back to <code>eq?</code>.
</p>
<p>
Methods for the following types are predefined:
</p>
<ul>
<li>
Two symbols are equal if they have the same string name.

</li>
<li>
Two numbers are equal if they are the same numerically.

</li>
<li>
Two strings are equal if they contain the same code points.

</li>
</ul>
</div>

</div>

<div id="outline-container-15.2" class="outline-3">
<h3 id="sec-15.2"><code>/= &lt;a&gt; &lt;b&gt; → boolean</code> [applicative] </h3>
<div class="outline-text-3" id="text-15.2">


<p>
Inequality predicate, defined in terms of <code>=</code>.
</p>
</div>

</div>

<div id="outline-container-15.3" class="outline-3">
<h3 id="sec-15.3"><code>eq? &lt;a&gt; &lt;b&gt; → boolean</code> [applicative] </h3>
<div class="outline-text-3" id="text-15.3">


<p>
Returns true if the two values are pointer identical, false otherwise.
</p>
<p>
Note: it is advised against using <code>eq?</code> except in special
circumstances.  Because not even symbols or small numbers that "are
the same" are guaranteed to be <code>eq?</code>, it can be confusing.  The
generic equality predicate <code>=</code> should almost always be
used instead.
</p>
</div>

</div>

<div id="outline-container-15.4" class="outline-3">
<h3 id="sec-15.4"><code>&lt; &lt;a&gt; &lt;b&gt; → boolean</code> [generic] </h3>
<div class="outline-text-3" id="text-15.4">


<p>
Generic binary comparison function.  A method is defined for numbers.
</p>
</div>

</div>

<div id="outline-container-15.5" class="outline-3">
<h3 id="sec-15.5"><code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code> [applicatives] </h3>
<div class="outline-text-3" id="text-15.5">


<p>
Binary comparison functions defined in terms of <code>&lt;</code> and <code>=</code>.
</p>
</div>

</div>

<div id="outline-container-15.6" class="outline-3">
<h3 id="sec-15.6"><code>hash-code &lt;obj&gt; → number</code> [generic] </h3>
<div class="outline-text-3" id="text-15.6">


<p>
Generic hash function.  Different types may attach different methods
to this generic function.  If no method is defined for a type, falls
back to <code>identity-hash-code</code>.
</p>
<p>
If two objects are generically equal by <code>=</code>, their
generic hash codes must be equal, too.  Conversely, if two objects
have different generic hash codes, they cannot be generically equal.
</p>
</div>

</div>

<div id="outline-container-15.7" class="outline-3">
<h3 id="sec-15.7"><code>identity-hash-code &lt;obj&gt; → number</code> [applicative] </h3>
<div class="outline-text-3" id="text-15.7">


<p>
Returns the system-determined identity hash code of the object, which
is equal if two objects are <code>eq?</code>.  It is unlikely that two different
objects have the same identity hash code.
</p>
</div>
</div>

</div>

<div id="outline-container-16" class="outline-2">
<h2 id="sec-16">Booleans </h2>
<div class="outline-text-2" id="text-16">


</div>

<div id="outline-container-16.1" class="outline-3">
<h3 id="sec-16.1"><code>and</code>, <code>or</code> [operatives] </h3>
<div class="outline-text-3" id="text-16.1">


<p>
Short-circuiting binary logical connectives.
</p>
</div>

</div>

<div id="outline-container-16.2" class="outline-3">
<h3 id="sec-16.2"><code>not</code> [applicative] </h3>
<div class="outline-text-3" id="text-16.2">


<p>
Unary logical connective.
</p>
</div>
</div>

</div>

<div id="outline-container-17" class="outline-2">
<h2 id="sec-17">Numbers </h2>
<div class="outline-text-2" id="text-17">



</div>

<div id="outline-container-17.1" class="outline-3">
<h3 id="sec-17.1"><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code> [applicatives] </h3>
<div class="outline-text-3" id="text-17.1">


<p>
The binary applicatives for addition, subtraction, multiplication,
division, and modulo.
</p>
</div>

</div>

<div id="outline-container-17.2" class="outline-3">
<h3 id="sec-17.2"><code>-&gt;number &lt;obj&gt; → number</code> [generic] </h3>
<div class="outline-text-3" id="text-17.2">


<p>
Turns some objects into a number.  Methods are defined for strings and
symbols, which are parsed as numbers.
</p>

</div>

<div id="outline-container-17.2.1" class="outline-4">
<h4 id="sec-17.2.1">Examples </h4>
<div class="outline-text-4" id="text-17.2.1">





<pre class="example">(assert (= 3.55 (-&gt;number 3.55)))
(assert (= 3.55 (-&gt;number "3.55")))
</pre>




</div>
</div>
</div>

</div>

<div id="outline-container-18" class="outline-2">
<h2 id="sec-18">Strings </h2>
<div class="outline-text-2" id="text-18">



</div>

<div id="outline-container-18.1" class="outline-3">
<h3 id="sec-18.1"><code>-&gt;string &lt;obj&gt; → string</code> [generic] </h3>
<div class="outline-text-3" id="text-18.1">


<p>
Turns any object into a string.  Methods are defined for all built-in
types.
</p>
</div>
</div>

</div>

<div id="outline-container-19" class="outline-2">
<h2 id="sec-19">Pairs and Lists </h2>
<div class="outline-text-2" id="text-19">



</div>

<div id="outline-container-19.1" class="outline-3">
<h3 id="sec-19.1"><code>cons &lt;car&gt; &lt;cdr&gt; → cons</code> [applicative] </h3>
<div class="outline-text-3" id="text-19.1">


<p>
Creates a new cons with the given car and cdr.
</p>
</div>

</div>

<div id="outline-container-19.2" class="outline-3">
<h3 id="sec-19.2"><code>car &lt;pair&gt; → value</code> [applicative] </h3>
<div class="outline-text-3" id="text-19.2">


<p>
Contents of the Address part of Register.
</p>
</div>

</div>

<div id="outline-container-19.3" class="outline-3">
<h3 id="sec-19.3"><code>cdr &lt;pair&gt; → value</code> [applicative] </h3>
<div class="outline-text-3" id="text-19.3">


<p>
Contents of the Decrement part of Register.
</p>
</div>

</div>

<div id="outline-container-19.4" class="outline-3">
<h3 id="sec-19.4"><code>caar</code>, <code>cadr</code>, <code>cdar</code>, <code>cddr</code> [applicatives] </h3>
<div class="outline-text-3" id="text-19.4">


<p>
Combinations of <code>car</code> and <code>cdr</code>, e.g. <code>(cadr x)</code> === <code>(car (cdr x))</code>.
</p>
</div>

</div>

<div id="outline-container-19.5" class="outline-3">
<h3 id="sec-19.5"><code>list . &lt;vals&gt; → list</code> [applicative] </h3>
<div class="outline-text-3" id="text-19.5">


<p>
Constructs a nil-terminated list containing the values.
</p>
</div>

</div>

<div id="outline-container-19.6" class="outline-3">
<h3 id="sec-19.6"><code>list* . &lt;vals&gt; → list</code> [applicative] </h3>
<div class="outline-text-3" id="text-19.6">


<p>
Constructs a list of the values, terminated by the last value.
</p>
</div>
</div>

</div>

<div id="outline-container-20" class="outline-2">
<h2 id="sec-20">Vectors </h2>
<div class="outline-text-2" id="text-20">


</div>

<div id="outline-container-20.1" class="outline-3">
<h3 id="sec-20.1"><code>vector . &lt;elements&gt; → vector</code> [applicative] </h3>
<div class="outline-text-3" id="text-20.1">


<p>
Creates a new vector with the given elements.
</p>
</div>

</div>

<div id="outline-container-20.2" class="outline-3">
<h3 id="sec-20.2"><code>vector-ref &lt;vector&gt; &lt;index&gt; → element</code> [applicative] </h3>
<div class="outline-text-3" id="text-20.2">


<p>
Returns the vector's element at the given index.
</p>
</div>

</div>

<div id="outline-container-20.3" class="outline-3">
<h3 id="sec-20.3"><code>vector-set! &lt;vector&gt; &lt;index&gt; &lt;element&gt; → element</code> [applicative] </h3>
<div class="outline-text-3" id="text-20.3">


<p>
Updates the vector's element at the given index and returns it.
</p>
</div>

</div>

<div id="outline-container-20.4" class="outline-3">
<h3 id="sec-20.4"><code>vector-length &lt;vector&gt; → number</code> [applicative] </h3>
<div class="outline-text-3" id="text-20.4">


<p>
Returns the number of elements in the vector.
</p>
</div>
</div>

</div>

<div id="outline-container-21" class="outline-2">
<h2 id="sec-21">Hashtables </h2>
<div class="outline-text-2" id="text-21">


</div>

<div id="outline-container-21.1" class="outline-3">
<h3 id="sec-21.1"><code>Hashtable</code> [variable], <code>hashtable?</code> [applicative] <i>NIY</i> </h3>
<div class="outline-text-3" id="text-21.1">


<p>
Hashtable type and type predicate.
</p>
</div>

</div>

<div id="outline-container-21.2" class="outline-3">
<h3 id="sec-21.2"><code>make-hashtable &lt;hashfn&gt; &lt;eqfn&gt; → hashtable</code> [applicative] <i>NIY</i> </h3>
<div class="outline-text-3" id="text-21.2">


<p>
Creates a new hashtable with the given hash function and equality function.
</p>
</div>

</div>

<div id="outline-container-21.3" class="outline-3">
<h3 id="sec-21.3"><code>make-identity-hashtable → hashtable</code> [applicative] </h3>
<div class="outline-text-3" id="text-21.3">


<p>
Creates a new hashtable with <code>identity-hash-code</code> as hash function and <code>eq?</code> as
equality function.
</p>
</div>

</div>

<div id="outline-container-21.4" class="outline-3">
<h3 id="sec-21.4"><code>make-generic-hashtable → hashtable</code> [applicative] <i>NIY</i> </h3>
<div class="outline-text-3" id="text-21.4">


<p>
Creates a new hashtable with <code>hash-code</code> as hash function and
<code>=</code> as equality function.
</p>
</div>

</div>

<div id="outline-container-21.5" class="outline-3">
<h3 id="sec-21.5"><code>hashtable-put! &lt;hashtable&gt; &lt;key&gt; &lt;val&gt; → val</code> [applicative] </h3>
<div class="outline-text-3" id="text-21.5">


<p>
Associates key with value in hashtable.
</p>
</div>

</div>

<div id="outline-container-21.6" class="outline-3">
<h3 id="sec-21.6"><code>hashtable-get &lt;hashtable&gt; &lt;key&gt; &lt;default&gt; → val</code> [applicative] </h3>
<div class="outline-text-3" id="text-21.6">


<p>
Returns value associated with key from hash, or default value if not
found.
</p>
</div>
</div>

</div>

<div id="outline-container-22" class="outline-2">
<h2 id="sec-22">System </h2>
<div class="outline-text-2" id="text-22">


</div>

<div id="outline-container-22.1" class="outline-3">
<h3 id="sec-22.1"><code>read → form</code> [applicative] </h3>
<div class="outline-text-3" id="text-22.1">


<p>
Reads a form from the console and returns it.
</p>
</div>

</div>

<div id="outline-container-22.2" class="outline-3">
<h3 id="sec-22.2"><code>display &lt;msg&gt; → msg</code> [applicative] </h3>
<div class="outline-text-3" id="text-22.2">


<p>
Prints a message string to the console and returns it.
</p>
</div>

</div>

<div id="outline-container-22.3" class="outline-3">
<h3 id="sec-22.3"><code>fail &lt;reason&gt; → |</code> [applicative] </h3>
<div class="outline-text-3" id="text-22.3">


<p>
Halts evaluation with an object describing the reason (typically an error).
</p>
</div>
</div>

</div>

<div id="outline-container-23" class="outline-2">
<h2 id="sec-23">JavaScript Bridge </h2>
<div class="outline-text-2" id="text-23">


<p>
The JavaScript object system is treacherous, so we don't even attempt
to somehow integrate it with Wat's.  It is urged to convert JavaScript
objects to Wat objects as early as possible with <code>from-js</code>, and
convert Wat objects to JavaScript objects as late as possible with
<code>to-js</code>.  JavaScript objects may not implement all Wat object
functionality, such as identity hash codes.
</p>

</div>

<div id="outline-container-23.1" class="outline-3">
<h3 id="sec-23.1"><code>js-global &lt;string&gt; → result</code> [applicative] </h3>
<div class="outline-text-3" id="text-23.1">


<p>
Returns value of JavaScript global variable with given name.
</p>
</div>

</div>

<div id="outline-container-23.2" class="outline-3">
<h3 id="sec-23.2"><code>js-set-global! &lt;string&gt; &lt;val&gt; → val</code> [applicative] </h3>
<div class="outline-text-3" id="text-23.2">


<p>
Updates value of JavaScript global variable with given name and returns it.
</p>
</div>

</div>

<div id="outline-container-23.3" class="outline-3">
<h3 id="sec-23.3"><code>js-prop &lt;object&gt; &lt;string&gt; → result</code> [applicative] </h3>
<div class="outline-text-3" id="text-23.3">


<p>
Returns value of JavaScript member variable with given name of object.
</p>
</div>

</div>

<div id="outline-container-23.4" class="outline-3">
<h3 id="sec-23.4"><code>js-set-prop! &lt;object&gt; &lt;string&gt; &lt;val&gt; → val</code> [applicative] </h3>
<div class="outline-text-3" id="text-23.4">


<p>
Updates value of JavaScript member variable with given name of object
and returns it.
</p>
</div>

</div>

<div id="outline-container-23.5" class="outline-3">
<h3 id="sec-23.5"><code>js-function &lt;jsfun&gt; → applicative</code> [applicative] </h3>
<div class="outline-text-3" id="text-23.5">


<p>
Creates an applicative that when called will call the given JavaScript
function with the arguments it received.
</p>
</div>

</div>

<div id="outline-container-23.6" class="outline-3">
<h3 id="sec-23.6"><code>js-method &lt;string&gt; → cmb</code> [applicative] </h3>
<div class="outline-text-3" id="text-23.6">


<p>
Creates an applicative that when called on an object and zero or more
arguments will invoke the method with the given string name of the
object with the given arguments.
</p>
</div>

</div>

<div id="outline-container-23.7" class="outline-3">
<h3 id="sec-23.7"><code>to-js &lt;obj&gt; → jsobj</code> [applicative] </h3>
<div class="outline-text-3" id="text-23.7">


<p>
Tries to convert a Wat object, such as a string, to a similar
JavaScript object.
</p>
</div>

</div>

<div id="outline-container-23.8" class="outline-3">
<h3 id="sec-23.8"><code>from-js &lt;js-obj&gt; → obj</code> [applicative] </h3>
<div class="outline-text-3" id="text-23.8">


<p>
Tries to convert a JavaScript object, such as a string, to a similar
Wat object.
</p>
</div>

</div>

<div id="outline-container-23.9" class="outline-3">
<h3 id="sec-23.9"><code>js-callback &lt;cmb&gt; → jsfun</code> [applicative] </h3>
<div class="outline-text-3" id="text-23.9">


<p>
Returns a JS function that, when called, will apply the provided
combiner with the arguments the callback received.
</p>
</div>

</div>

<div id="outline-container-23.10" class="outline-3">
<h3 id="sec-23.10"><code>define-js-method &lt;name&gt;</code> [operative] </h3>
<div class="outline-text-3" id="text-23.10">

<p><code>(define-js-method &lt;name&gt;)</code> is equivalent to <code>(define &lt;name&gt; (js-method (symbol-&gt;string &lt;name&gt;)))</code>.
</p></div>
</div>
</div>
<div id="postamble">
<p class="author"> Author: Manuel Simoni
<a href="mailto:msimoni@gmail.com">&lt;msimoni@gmail.com&gt;</a>
</p>
<p class="date"> Date: 2012-08-28 01:27:42 CEST</p>
</div>
</div>
</body>
</html>
